

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="fa" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="fa" > <!--<![endif]-->
<html dir="rtl" lang="fa">
    <head>
        
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    
         <title>بلمن فورد &mdash; نظریه گراف‌ها برای المپیاد کامپیوتر</title>
    




    

    <link rel="stylesheet" type=text/css href="/_static/main.css">

    <link rel="stylesheet" type=text/css href="../../_static/pygments.css">

    <link rel="stylesheet" type=text/css href="../../_static/minoo-rtl.css">



<link rel="stylesheet" type=text/css href="../../_static/font-awesome.min.css">
<link rel="stylesheet" type=text/css href="../../_static/bootstrap.min.css">
<link rel="stylesheet" type=text/css href="../../_static/pygment-solarized-light.css">


    <link rel="stylesheet" type=text/css href="../../_static/minoo-rtl.css">

        <link rel="index" title="فهرست" href="../../genindex.html" />
        <link rel="search" title="جستجو" href="../../search.html" />
        <link rel="top" title="نظریه گراف‌ها برای المپیاد کامپیوتر" href="../../index.html" />
        <link rel="up" title="الگوریتم های کوتاه ترین مسیر" href="index.html" />
        <link rel="next" title="دکسترا" href="2.html" />
        <link rel="prev" title="الگوریتم های کوتاه ترین مسیر" href="index.html" />



    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>

    
        <script type="text/javascript" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/translations.js"></script>
        <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script type="text/javascript" src="../../None"></script>
        <script type="text/javascript" src="../../_static/searchtools.js"></script>


<script type="text/javascript" src="../../_static/minoo.js"></script>
<script type="text/javascript" src="../../_static/modernizr.min.js"></script>
<style>
    * {
        border-radius: 1rem;
    }
</style>
    </head>
    <body>
        <div id="page">
            <div id="wrapper-page-sidebar">
                

<div id="page-sidebar">
<div id="sidebar-top">
    <div id="sidebar-top-image">
        <span style="background-image: url('../../_static/avatar.png');"></span>
    </div>
    <div id="sidebar-top-links">
        
            <a href=http://git.coderz.ir target="_blank"><i class="fa fa-globe" style="font-size:23px;"></i></a>
        
        
        
        
        
        
            <a href=https://github.com/dariubs/git target="_blank"><i class="fa fa-github-square" style="font-size:23px;"></i></a>
        
        
    </div>
    <div id="sidebar-navigation">
        <span id="navigation-toggle"><i class="fa  fa-angle-double-left " id="sidebar-toggle-icon" style="font-size: 27px;"></i></span>
        <span id="navigation-search">
                <form action="../../search.html" method="get">
                    <input id="input-search" type="text" name="q"  placeholder="جستجو">
                    <input type="hidden" name="check_keywords" value="yes" />
                    <input type="hidden" name="area" value="default" />
                </form>
        </span>
    </div>
    <div id="sidebar-top-title">
        <a href="../../index.html">نظریه گراف‌ها برای المپیاد کامپیوتر</a>
    </div>
</div>

<div id="wrapper-sidebar-bottom">
<div id="sidebar-bottom">
    <div id="sidebar-bottom-list">
        
        
            <div id="tree-toc">
            <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../1/index.html">تعاریف اولیه</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../1/1.html">مقدمات و مدل سازی با گراف</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1/2.html">انواع گراف</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1/3.html">پیاده سازی گراف</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1/4.html">گشت، گذر، مسیر، اکسترمال</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1/5.html">زیرگراف ها</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1/6.html">همبندی، یال برشی و راس برشی</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1/7.html">گراف دو بخشی</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../2/index.html">درخت ها</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../2/1.html">خاصیت های مقدماتی</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2/2.html">فاصله در درخت و گراف</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2/3.html">شمردن تعداد درخت ها</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2/4.html">DFS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2/5.html">BFS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2/6.html">الگوریتم پیدا کردن قطر درخت</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2/7.html">DFS Start/Finish Time</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2/8.html">الگوریتم های راس و یال برشی</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2/9.html">کارگاه پرورش ایده</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../3/index.html">گراف جهت‌دار</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../3/1.html">تعاریف</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3/2.html">تورنومنت</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3/3.html">گراف جهت‌دار بدون دور</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3/4.html">مولفه‌های قویا همبند</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3/5.html">تشخیص دور داشتن گراف جهت دار</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3/6.html">بازی‌ها و گراف جهت‌دار</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3/7.html">گراف تابعی و گراف‌جایگشت</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../4/index.html">تکنیک های اثبات مسائل گراف</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../4/1.html">انتخاب های اکسترمالی</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4/2.html">منقبض کردن</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4/3.html">گراف و جادو</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../5/index.html">تور اویلری و دور همیلتونی</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../5/1.html">معرفی</a></li>
<li class="toctree-l2"><a class="reference internal" href="../5/2.html">تور اویلری در گراف جهت دار و بی جهت</a></li>
<li class="toctree-l2"><a class="reference internal" href="../5/3.html">De Bruijn sequence</a></li>
<li class="toctree-l2"><a class="reference internal" href="../5/4.html">قضیه های وجودی دور همیلتونی</a></li>
<li class="toctree-l2"><a class="reference internal" href="../5/5.html">الگوریتم های نمایی پیدا کردن دور و مسیر همیلتونی</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">الگوریتم های کوتاه ترین مسیر</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">بلمن فورد</a></li>
<li class="toctree-l2"><a class="reference internal" href="2.html">دکسترا</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.html">فلوید وارشال</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../7/index.html">ماتریس ها</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../7/1.html">ماتریس و عملیات های روی آن</a></li>
<li class="toctree-l2"><a class="reference internal" href="../7/2.html">دترمینان ماتریس ها</a></li>
<li class="toctree-l2"><a class="reference internal" href="../7/3.html">ماتریس وقوع</a></li>
<li class="toctree-l2"><a class="reference internal" href="../7/4.html">ماتریس مجاورت</a></li>
<li class="toctree-l2"><a class="reference internal" href="../7/5.html">تعداد گشت ها به طول n</a></li>
<li class="toctree-l2"><a class="reference internal" href="../7/6.html">به دست آوردن توابع بازگشتی به کمک گراف و ماتریس</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../8/index.html">داده ساختار های درختی</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../8/1.html">درخت دودویی (Binary Tree)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../8/2.html">درخت جست و جوی دودویی (BST یا Binary Search Tree)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../8/3.html">Heap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../8/4.html">DSU</a></li>
<li class="toctree-l2"><a class="reference internal" href="../8/5.html">Segment Tree</a></li>
<li class="toctree-l2"><a class="reference internal" href="../8/6.html">Trie</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../9/index.html">مسائل np و np کامل</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../9/1.html">تعریف np و np کامل</a></li>
<li class="toctree-l2"><a class="reference internal" href="../9/2.html">اثبات np کامل بودن مساله sat</a></li>
<li class="toctree-l2"><a class="reference internal" href="../9/3.html">مسائل np کامل گراف</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../10/index.html">Lca</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../10/1.html">شرح مساله</a></li>
<li class="toctree-l2"><a class="reference internal" href="../10/2.html">راه حل O(n+q*lg(n)) به کمک جداسازی سبک-سنگین</a></li>
<li class="toctree-l2"><a class="reference internal" href="../10/3.html">الگوریتم برون‌خط تارجان</a></li>
<li class="toctree-l2"><a class="reference internal" href="../10/4.html">ارتباط LCA و RMQ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../10/5.html">راه خطی برای LCA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../10/6.html">درخت مجازی</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../11/index.html">الگوریتم های پیشرفته درخت</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../11/1.html">درخت پوشای کمینه</a></li>
<li class="toctree-l2"><a class="reference internal" href="../11/2.html">گونی</a></li>
<li class="toctree-l2"><a class="reference internal" href="../11/3.html">سنتروید</a></li>
<li class="toctree-l2"><a class="reference internal" href="../11/4.html">هافمن کدینگ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../11/5.html">هش درخت</a></li>
<li class="toctree-l2"><a class="reference internal" href="../11/6.html">تجزیه سبک سنگین(HLD)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../12/index.html">همبندی</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../12/1.html">برش ها و همبندی</a></li>
<li class="toctree-l2"><a class="reference internal" href="../12/2.html">گراف k همبند</a></li>
<li class="toctree-l2"><a class="reference internal" href="../12/3.html">برش کمینه و جریان بیشینه</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../13/index.html">تطابق</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../13/1.html">آشنایی</a></li>
<li class="toctree-l2"><a class="reference internal" href="../13/2.html">تطابق در گراف دوبخشی</a></li>
<li class="toctree-l2"><a class="reference internal" href="../13/3.html">قضایا ی مینماکس</a></li>
<li class="toctree-l2"><a class="reference internal" href="../13/4.html">کاربرد ها</a></li>
<li class="toctree-l2"><a class="reference internal" href="../13/5.html">جریان بیشینه و تطابق</a></li>
<li class="toctree-l2"><a class="reference internal" href="../13/6.html">Poset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../13/7.html">تطابق در گراف های عام</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../14/index.html">مباحث ویژه</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../14/1.html">گراف مسطح</a></li>
<li class="toctree-l2"><a class="reference internal" href="../14/2.html">دنباله درجه ای</a></li>
<li class="toctree-l2"><a class="reference internal" href="../14/3.html">رنگ آمیزی</a></li>
<li class="toctree-l2"><a class="reference internal" href="../14/4.html">یک ریختی</a></li>
<li class="toctree-l2"><a class="reference internal" href="../14/5.html">Random Walk</a></li>
<li class="toctree-l2"><a class="reference internal" href="../14/6.html">اعداد رمزی</a></li>
<li class="toctree-l2"><a class="reference internal" href="../14/7.html">مجموعه مستقل و خوشه</a></li>
<li class="toctree-l2"><a class="reference internal" href="../14/8.html">2-SAT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../14/9.html">چند ماتریس خاص</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/index.html">ضمیمه</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../appendix/1.html">چگونه از این کتاب استفاده کنیم؟</a></li>
<li class="toctree-l2"><a class="reference internal" href="../appendix/2.html">آشنایی با الگوریتم ها و پیچیدگی</a></li>
<li class="toctree-l2"><a class="reference internal" href="../appendix/3.html">برگه تقلب (Cheat sheet)</a></li>
</ul>
</li>
</ul>

            </div>
        
   </div>
   <div id="sidebar-bottom-versions">
      

   </div>
</div>
</div>
</div>
            </div>
            <div id="page-body">
                <div class="container-fluid">
                        <div id="body-content" style="max-width: 800px">

                            <div class="row-fluid">
			        <div class="col-lg-12">
				    

<div id="body-top">
    
    
        <a href="../../index.html"><i class="fa fa-folder-o"></i>&nbsp; فهرست</a>&nbsp;
        <a><i class="fa  fa-angle-left"></i></a>&nbsp;
        <a><i class="fa fa-folder-open-o"></i>&nbsp; بلمن فورد</a>
    
    
        <a style="float: left; padding-right: 20px;" href="/problems/" id="problems-link"><i class="fa fa-question on fa-circle"></i>&nbsp;سوالات</a>
        <script>document.getElementById('problems-link').href=`/problems/${window.location.pathname.slice(6).replace('/','.')}.html`.replace('.html.html', '.html').replace('/.html', '/').replace('.index.html', '.html');</script>
        <a style="float: left; padding-right: 20px;" href="/en/" id="lang-link"><i class="fa fa-language on fa-circle"></i>&nbsp;Change Language (English)</a>
        <script>document.getElementById('lang-link').href=`/en${window.location.pathname}`;</script>
        
            <a href="../../_sources/book/6/1.rst.txt" rel="nofollow" id="top-src" target="_blank"><i class="fa fa-code"></i>&nbsp; سورس</a>
        
    
</div>
			        </div>
			    </div>
                            
                            <div class="row-fluid">
			        <div class="col-lg-12">
				    
  <section id="id1">
<h1>بلمن فورد<a class="headerlink" href="#id1" title="پیوند ثابت به این سر مقاله">¶</a></h1>
<section id="id2">
<h2>صورت مسئله<a class="headerlink" href="#id2" title="پیوند ثابت به این سر مقاله">¶</a></h2>
<p>یک گراف جهت دار وزن دار
<span class="math notranslate nohighlight">\(G\)</span>
داریم. وزن یال های <span class="math notranslate nohighlight">\(G\)</span> میتواند منفی نیز باشد. میدانیم گراف <span class="math notranslate nohighlight">\(G\)</span> دور با مجموع وزن منفی ندارد.</p>
<p>حال میخواهیم به ازای هر راس طول کوتاه ترین مسیر از راس <span class="math notranslate nohighlight">\(sc\)</span> به بقیه رئوس را پیدا کنیم که طول یک مسیر برابر جمع وزن های یال های آن است.</p>
</section>
<section id="id3">
<h2>الگوریتم بلمن فورد<a class="headerlink" href="#id3" title="پیوند ثابت به این سر مقاله">¶</a></h2>
<p>برای حل این مسئله ابتدا یک <span class="math notranslate nohighlight">\(dp\)</span> با ابعاد
<span class="math notranslate nohighlight">\(|V(G)| * |V(G)|\)</span>
تعریف میکنیم که <span class="math notranslate nohighlight">\(dp_{i,j}\)</span> برابر طول کوتاه ترین گشت از راس <span class="math notranslate nohighlight">\(sc\)</span> به راس <span class="math notranslate nohighlight">\(j\)</span> است که تعداد یال های این گشت حداکثر برابر <span class="math notranslate nohighlight">\(i\)</span> است.</p>
<p>حال میدانیم طول کوتاه ترین گشت بین 2 راس در گراف <span class="math notranslate nohighlight">\(G\)</span> برابر طول کوتاه ترین مسیر نیز میباشد چون اگر کوتاه ترین گشت دارای 2 راس تکراری باشد یک دور داریم که طول آن مثبت است (طبق فرض سوال نمیتواند طول دور منفی باشد.) پس میتوان ان را حذف کرد و به یک گشت با طول کمتر رسید که تناقض است.</p>
<p>حال برای پایه های این دپپی میدانیم که <span class="math notranslate nohighlight">\(dp_{i, sc} = 0\)</span> و
<span class="math notranslate nohighlight">\(dp_{0, u \neq sc} = \infty\)</span>
است. حال برای بدست اوردن <span class="math notranslate nohighlight">\(dp_{i, j}\)</span> روی تمامی یال هایی که به <span class="math notranslate nohighlight">\(j\)</span> وارد میشوند حالت بندی میکنیم. اگر به ازای هر یال <span class="math notranslate nohighlight">\(e\)</span> که از <span class="math notranslate nohighlight">\(u_e\)</span> به <span class="math notranslate nohighlight">\(j\)</span> وارد می شود و وزن آن <span class="math notranslate nohighlight">\(w_e\)</span> است، مقدار
<span class="math notranslate nohighlight">\(dp_{i-1, u_e} + w_e\)</span>
را حساب کنیم کمینه این مقدارها جواب
<span class="math notranslate nohighlight">\(dp_{i, j}\)</span>
می شود. در نتیجه :</p>
<div class="math notranslate nohighlight">
\[dp_{i, j} = \displaystyle{\min_{\forall \, e \: \in \: N_{j}^{-}(j)}} dp_{i-1, u_e} + w_e`\]</div>
<p>برای بدست آوردن طول کوتاه ترین مسیر از راس <span class="math notranslate nohighlight">\(sc\)</span> به راس <span class="math notranslate nohighlight">\(u\)</span> داشتن مقدار <span class="math notranslate nohighlight">\(dp_{n-1, u}\)</span> کافی است. چون که مسیر از راس <span class="math notranslate nohighlight">\(sc\)</span> به یک راس دیگر حداکثر دارای <span class="math notranslate nohighlight">\(n\)</span> راس و <span class="math notranslate nohighlight">\(n-1\)</span> یال است و طبق تعریف دیپی و اینکه کوتاه ترین گشت بین 2 راس در <span class="math notranslate nohighlight">\(G\)</span> حتما مسیر است، این مقدار دقیقا همان مقدار مورد نیاز است.</p>
</section>
<section id="id4">
<h2>تحلیل اردر<a class="headerlink" href="#id4" title="پیوند ثابت به این سر مقاله">¶</a></h2>
<p>برای اپدیت کردن کل خانه های <span class="math notranslate nohighlight">\(dp_i\)</span> به ازای هر راس به اندازه درجه ورودی آن عملیات انجام داده ایم. میدانیم که جمع درجه ورودی تمام راس ها برابر
<span class="math notranslate nohighlight">\(|E(G)|\)</span>
است. پس در کل
<span class="math notranslate nohighlight">\(\mathcal{O}\left(|V(G)|.|E(G)|\right)\)</span>
عملیات انجام داده ایم. اردر حافظه استفاده شده نیز
<span class="math notranslate nohighlight">\(\mathcal{O}\left(|V(G)|^2\right)\)</span>
است.</p>
</section>
<section id="id5">
<h2>بهینه سازی اردر حافظه<a class="headerlink" href="#id5" title="پیوند ثابت به این سر مقاله">¶</a></h2>
<p>برای بهینه سازی مقدار حافظه مصرفی، میتوان بعد اول را حذف کرد. در نتیجه اردر حافظه مصرفی برابر
<span class="math notranslate nohighlight">\(\mathcal{O}\left(|V(G)|\right)\)</span>
میشود.</p>
<p>سپس
<span class="math notranslate nohighlight">\(|V(E)| - 1\)</span>
مرحله به ازای هر یال مقدار <span class="math notranslate nohighlight">\(dp\)</span> راس ته یال را اپدیت کرد. منظور از اپدیت کردن این است که اگر یال <span class="math notranslate nohighlight">\(e\)</span> از راس <span class="math notranslate nohighlight">\(u_e\)</span> به <span class="math notranslate nohighlight">\(v_e\)</span> برود و وزن آن <span class="math notranslate nohighlight">\(w_e\)</span> باشد،
<span class="math notranslate nohighlight">\(dp_{v_e} = min(dp_{v_e}, dp_{u_e} + w_e)\)</span>
را قرار دهیم.</p>
<p>حال یک سوال پیش می آید که آیا با انجام این کار مقدار خانه های
<span class="math notranslate nohighlight">\(dp\)</span>
همان مقدار مورد نظر باقی می ماند یا نه؟ پاسخ این سوال بله است.</p>
<p>اگر دیپی در قسمت قبلی را
<span class="math notranslate nohighlight">\(dp^{\prime}\)</span>
در نظر بگیریم بعد از مرحله <span class="math notranslate nohighlight">\(i\)</span> میدانیم <span class="math notranslate nohighlight">\(dp_u\)</span> برابر یکی از
<span class="math notranslate nohighlight">\(dp_{i, u}^{\prime}, dp_{i+1, u}^{\prime}, \dots, dp_{n-1, u}^{\prime}\)</span>
است. (اثبات این لم بر عهده خواننده).</p>
<p>حال اگر بعد از مرحله <span class="math notranslate nohighlight">\(n-1\)</span> مین بررسی کنیم میفهمیم که
<span class="math notranslate nohighlight">\(dp_u = dp_{n-1, u}^{\prime}\)</span>
است. در نتیجه بعد از مرحله <span class="math notranslate nohighlight">\(n-1\)</span> مین مرحله مقدار خانه های <span class="math notranslate nohighlight">\(dp\)</span> همان مقدار های مطلوب است.</p>
</section>
<section id="id6">
<h2>پیدا کردن کوتاه ترین مسیر<a class="headerlink" href="#id6" title="پیوند ثابت به این سر مقاله">¶</a></h2>
<p>بعد از همه این صحبت ها، یک سوال برایتان پیش می آید و آن این است که اگر خود مسیر بهینه از <span class="math notranslate nohighlight">\(sc\)</span> به یک راس دیگر مانند <span class="math notranslate nohighlight">\(des\)</span> را بخواهیم، چه باید بکنیم؟</p>
<p>برای حل این پرسش باید کمی الگوریتم قبلی را تغییر دهیم. یک آرایه
<span class="math notranslate nohighlight">\(|V(G)|\)</span>
عضوی کمکی به نام <span class="math notranslate nohighlight">\(par\)</span> در نظر میگیریم. در ابتدا تمامی خانه های <span class="math notranslate nohighlight">\(par\)</span> را برابر 1- قرار میدهیم. حال اگر در وقتی یال <span class="math notranslate nohighlight">\(e\)</span> را در نظر گرفتیم
<span class="math notranslate nohighlight">\(dp_{v_e} &gt; dp_{u_e} + w_e\)</span>
بود،
<span class="math notranslate nohighlight">\(par_{v_e}\)</span>
را برابر <span class="math notranslate nohighlight">\(u_v\)</span> قرار میدهیم.</p>
<p><span class="math notranslate nohighlight">\(par_u\)</span>
عملا برابر راس قبلی در مسیر بهینه از <span class="math notranslate nohighlight">\(sc\)</span> به <span class="math notranslate nohighlight">\(u\)</span> است. برای بدست اوردن مسیر از <span class="math notranslate nohighlight">\(sc\)</span> به <span class="math notranslate nohighlight">\(des\)</span>، یک متغیر <span class="math notranslate nohighlight">\(nw\)</span> نگه میداریم و تا وقتی که
<span class="math notranslate nohighlight">\(nw \neq sc\)</span>
است، <span class="math notranslate nohighlight">\(nw\)</span> را برابر <span class="math notranslate nohighlight">\(par_{nw}\)</span> قرار میدهیم و <span class="math notranslate nohighlight">\(nw\)</span> را به ابتدا مسیر بدست امده فعلی اضافه میکنیم.</p>
<p>برای اثبات اینکه اثبات کنیم که حتما به راس <span class="math notranslate nohighlight">\(sc\)</span> میرسیم و مسیری که بدست می اوریم مسیری بهینه است، یک ارایه <span class="math notranslate nohighlight">\(lst\)</span> فرض میکنیم. <span class="math notranslate nohighlight">\(lst_u\)</span> برابر شماره اخرین مرحله ای است که <span class="math notranslate nohighlight">\(dp_u\)</span> عوض شده است. میدانیم
<span class="math notranslate nohighlight">\(lst_u &gt; lst_{par_u}\)</span>
است. (اثبات به عهده خواننده) پس هر بار که <span class="math notranslate nohighlight">\(nw\)</span> را برابر
<span class="math notranslate nohighlight">\(par_{nw}\)</span>
می کنیم، <span class="math notranslate nohighlight">\(lst_{nw}\)</span> کاهش میابد پس به دور نمیخوریم و حتما به <span class="math notranslate nohighlight">\(sc\)</span> خواهیم رسید.</p>
<p>طول مسیر نیز برابر <span class="math notranslate nohighlight">\(dp_{des}\)</span> خواهد بود چون هر مرحله اگر یک یال با وزن <span class="math notranslate nohighlight">\(w\)</span> را به مسیر اضافه کنیم، مقدار <span class="math notranslate nohighlight">\(dp_{nw}\)</span> دقیقا به انداره <span class="math notranslate nohighlight">\(w\)</span> کاهش میابد. چون <span class="math notranslate nohighlight">\(dp_{sc} = 0\)</span> است طول مسیر دقیقا برابر <span class="math notranslate nohighlight">\(dp_{des}\)</span> میشود.</p>
</section>
<section id="id7">
<h2>دور منفی<a class="headerlink" href="#id7" title="پیوند ثابت به این سر مقاله">¶</a></h2>
<p>ممکن است برایتان سوال شود اگر تضمین نشود که گراف دور منفی دارد یا نه چگونه بفهمیم دور منفی داریم ؟ (در حالتی که حافظه را بهینه سازی کرده ایم).</p>
<p>ابتدا فرض کنید به جای
<span class="math notranslate nohighlight">\(|V(G)| - 1\)</span>
مرحله،
<span class="math notranslate nohighlight">\(|V(G)|\)</span>
مرحله اجرا میکنیم.
به یک مرحله از الگوریتم خوب میگوییم اگر مقدار حداقل یکی از خانه های  <span class="math notranslate nohighlight">\(dp\)</span> عوض شود. حال میدانیم اگر مرحله  <span class="math notranslate nohighlight">\(i\)</span> م خوب نباشد آنگاه مراحل بعدی نیز خوب نیستند. (اگر مقداری عوض نشود مراحل بعدی هم دقیقا همانند مصل مرحله  <span class="math notranslate nohighlight">\(i\)</span> م میشوند و خانه ای عوض نمیشود).</p>
<p>حال اگر دور منفی نداشته باشیم طبق استدلال های قبلی مرحله <span class="math notranslate nohighlight">\(|V(G)|\)</span> م حتما خوب نیست.(تمامی خانه ها به مقدار نهایی در مرحله قبل رسیده اند و عوض نخواهند شد).
حال اگر یک دور منفی وجود داشته باشد میدانیم مقدار  <span class="math notranslate nohighlight">\(dp\)</span> رِئوس آن هیچگاه ثابت نخواهد شد. خود دور منفی را میتوان چند بار طی کرد، که باعث میشود مقادیر  <span class="math notranslate nohighlight">\(dp\)</span> رئوس دور به
<span class="math notranslate nohighlight">\(-\infty\)</span>
نزدیک شوند. حال میدانیم اگر یک مرحله خوب نباشد انگاه تمامی مقادیر ثابت شده اند. طبق این حرف ها نتیجه میشود اگر دور منفی داشته باشیم تمامی مراحل خوب خواهند بود.</p>
<p>حال میدانیم اگر دور منفی نداشته باشیم مرحله <span class="math notranslate nohighlight">\(|V(G)|\)</span> م خوب نیست و اگر دور منفی داشته باشیم <span class="math notranslate nohighlight">\(|V(G)|\)</span> م حتما خوب است.
پس برای چک کردن داشتن دور منفی کافیست خوب بودن مرحله <span class="math notranslate nohighlight">\(|V(G)|\)</span> م را بررسی کنیم.</p>
<p>برای پیدا کردن خود دور منفی مثل حالت بدون دور منفی یک ارایه کمکی به نام  <span class="math notranslate nohighlight">\(par\)</span>  بگیرید و از یک راس که در مرحله <span class="math notranslate nohighlight">\(|V(G)|\)</span> م عوض شده مسیر بهینه از  <span class="math notranslate nohighlight">\(sc\)</span>  را پیدا کنید دور منفی در این مسیر حتما امده است. (این بخش با توجه به استدلال های همین بخش قابل اثبات است).</p>
</section>
</section>


			        </div>
			    </div>

                            <div class="row-fluid">
			        <div class="col-lg-12">
				    

        
            <div id="body-btn">
                
                    
                    <a href="index.html" style="float:right;" title="الگوریتم های کوتاه ترین مسیر" accesskey="p"><i class="fa fa-chevron-right"></i>&nbsp; قبلی</a>
                    
                    
                    <a href="2.html" style="float:left;" title="دکسترا" accesskey="n">بعدی &nbsp;<i class="fa fa-chevron-left"></i></a>
                    
                
            </div>
        


        <div id="body-footer">
            <div>
                <a href="https://shaazzz.ir/">
                    <img style="max-width: unset;"  src="/_static/shaazzz_logo.png">
                </a>
            </div>
            <div id="text">
                <p>
                    این کتاب توسط 
                    <a href="/contributors">
                    مشارکت کنندگان شاززز
                    </a>
                    به وجود آمده است.
                </p>
                <p>
                    این کتاب عمومی است و تحت
                    <a href="https://pdcommunity.ir/license/cc-by-sa/">
                        پروانه cc-by-sa
                    </a>
                    در دسترس است.
                </p>
                    <p style="font-size: 13px;">
                        آخرین به روز رسانی در اکتبر 13, 2025.
                    </p>
                <p style="font-size: 13px;">
                    
                        ساخته شده به وسیله <a href="http://sphinx-doc.org/">Sphinx</a> (4.3.2) و <a href="https://github.com/saeiddrv/SphinxMinooTheme">تم مینو</a> (Beta 0.9.7).
                    
                </p>
            </div>
            <div>
                <a href="https://pdcommunity.ir/license/cc-by-sa/">
                    <img style="max-width: unset;" src="/_static/cc-by-sa.svg">
                </a>
            </div>
        </div>
			        </div>
			    </div>
                            
                        </div>
                </div>
            </div>
            <span class="back-to-top">
                <i class="fa fa-arrow-circle-up"></i>
            </span>
        </div>
    </body>
</html>